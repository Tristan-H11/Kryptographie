<mat-expansion-panel>
    <mat-expansion-panel-header>
        <mat-panel-title>
            {{ client.name }}
        </mat-panel-title>
        <mat-panel-description>
            Die Ansicht von {{ client.name }}
        </mat-panel-description>
    </mat-expansion-panel-header>

    <mat-expansion-panel>
        <mat-expansion-panel-header>
            <mat-panel-title>
                Schlüsselpaar
            </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="card-container">

            <mat-card class="spaced-card">
                <mat-card-header>
                    <mat-card-title>Domainparameter</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    Kurve: y² = x³ + <strong>({{ client.keyPair | emptyIfUndefined:'public_key.curve.a' }})</strong> x
                    (mod
                    <strong>{{ client.keyPair | emptyIfUndefined:'public_key.curve.prime' }}</strong>)
                    <br>
                    Generator: <strong>G({{ client.keyPair | emptyIfUndefined:'public_key.curve.generator.x' }}
                    , {{ client.keyPair | emptyIfUndefined:'public_key.curve.generator.y' }})</strong>
                    <br>
                    Ordnung der von G erzeugten Untergruppe:
                    <strong>{{ client.keyPair | emptyIfUndefined:'public_key.curve.order_of_subgroup' }}</strong>
                </mat-card-content>
            </mat-card>

            <mat-card class="spaced-card">
                <mat-card-header>
                    <mat-card-title>Öffentliche Komponenten</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    Gewähltes Gruppenelement: <strong>Y({{ client.keyPair | emptyIfUndefined:'public_key.y.x' }}
                    , {{ client.keyPair | emptyIfUndefined:'public_key.y.y' }}
                    )</strong>
                </mat-card-content>
            </mat-card>

            <mat-card style="flex: 1; margin: 1%">
                <mat-card-header>
                    <mat-card-title>Private Komponenten</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    Geheimwert x = <strong>{{ client.keyPair | emptyIfUndefined:'private_key.x' }}</strong>
                </mat-card-content>
            </mat-card>
        </div>
    </mat-expansion-panel>
    <br>
    <mat-form-field appearance="outline" class="width-100">
        <mat-label>Klartext</mat-label>
        <textarea matInput placeholder="Das ist ein wunderbarer Tag..." [(ngModel)]="client.plaintext"></textarea>
    </mat-form-field>
    <br>
    <mat-form-field appearance="outline" class="width-100">
        <mat-label>Geheimtext - Zeichenkette</mat-label>
        <textarea matInput placeholder="Qnf vfg rva jhaqreonere Gnt..."
                  [(ngModel)]="client.ciphertext.encrypted_message"></textarea>
    </mat-form-field>
    <br>

    <div style="display:flex; justify-content: space-between">
        <mat-card style="flex: 1; margin-right: 1%;">
            <mat-card-header>
                <mat-card-title>Signatur</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                r = <strong>{{ client.signature.r }}</strong>
                <br>
                s = <strong>{{ client.signature.s }}</strong>
                <p>Die soeben entschlüsselte Nachricht ist <strong>{{ client.signature_valid }}</strong></p>
            </mat-card-content>
        </mat-card>

        <mat-expansion-panel style="flex: 1; margin-left: 1%;">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Geheimtext - Punkte
                </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-form-field appearance="outline" class="width-100">
                <textarea matInput [disabled]="true">{{ JSON.stringify(client.ciphertext.points) }}</textarea>
            </mat-form-field>
        </mat-expansion-panel>
    </div>

    <mat-action-row>
        <mat-form-field appearance="outline">
            <mat-label>Senden an</mat-label>
            <mat-select [(value)]="this.client.sendingTo">
                <mat-option *ngFor="let client of possibleTargetClients" [value]="client">{{ client.name }}</mat-option>
            </mat-select>
        </mat-form-field>
        <button mat-flat-button color="warn" (click)="delete()">{{ client.name }} löschen</button>
        <button mat-flat-button color="primary" (click)="clearFields()">Felder leeren</button>
        <button mat-flat-button color="primary"
                [disabled]="client.plaintext.length<1 || !client.sendingTo?.keyPair"
                (click)="encrypt()">Verschlüsseln
        </button>
        <button mat-flat-button color="primary" [disabled]="client.ciphertext.encrypted_message.length<1"
                (click)="decrypt()">Entschlüsseln
        </button>
        <button mat-flat-button color="primary" [disabled]="sendingToNotSet()" (click)="send()">Senden</button>
    </mat-action-row>

</mat-expansion-panel>
